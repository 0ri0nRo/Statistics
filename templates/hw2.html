<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Random Walk - Multiple Simulations</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            margin: 20px;
            background-color: #f9f9f9;
            color: #333;
        }

        h1,
        h2,
        h3 {
            color: #003366;
            margin-top: 20px;
            margin-bottom: 10px;
        }

        p {
            margin: 10px 0;
            text-align: justify;
        }

        code {
            background-color: #e0e0e0;
            padding: 2px 5px;
            border-radius: 3px;
        }

        .container {
            margin-top: 20px;
        }

        .input-group {
            margin: 10px 0;
        }

        label {
            display: inline-block;
            width: 150px;
        }

        input[type="number"] {
            width: 80px;
            padding: 5px;
        }

        button {
            padding: 10px 15px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
        }

        button:hover {
            background-color: #45a049;
        }

        #plot-canvas,
        #mean-canvas,
        #variance-canvas,
        #frequency-canvas,
        #bernoulli-canvas,
        #random-walk-canvas {
            margin-top: 20px;
            border: 1px solid #ccc;
        }

        .graph-title {
            background-color: #4A90E2;
            color: white;
            padding: 10px;
            text-align: center;
            border-radius: 5px;
            margin-bottom: 10px;
            font-size: 24px;
            font-weight: bold;
        }
    </style>
</head>

<body>

    <h1>Random Walk - Multiple Simulations</h1>
    <h2>1. Random Walk Simulation with Multiple Paths</h2>
    <p>
        This simulation generates multiple random walks, each path representing a different trajectory.
        The steps of each random walk are drawn from a normal (Gaussian) distribution with mean 0 and variance 1.
    </p>

    <div class="container">
        <div class="input-group">
            <label for="steps">Number of Steps:</label>
            <input type="number" id="steps" value="100" min="10" max="1000">
        </div>
        <div class="input-group">
            <label for="paths">Number of Paths:</label>
            <input type="number" id="paths" value="10" min="1" max="100">
        </div>
        <div class="input-group">
            <label for="time-step">Time Step (Δt):</label>
            <input type="number" id="time-step" value="0.01" min="0.001" max="1" step="0.001">
        </div>
        <div class="input-group">
            <label for="jump-prob">Jump Probability (p):</label>
            <input type="number" id="jump-prob" value="0.1" min="0.0" max="1.0" step="0.01">
        </div>
        <button id="run-simulation">Run Simulation</button>
    </div>

    <div id="results">
        <h2 class="graph-title">Simulation Output</h2>
        <canvas id="plot-canvas" width="800" height="400"></canvas>

        <h2 class="graph-title">Mean Trajectories</h2>
        <canvas id="mean-canvas" width="800" height="400"></canvas>

        <h2 class="graph-title">Variance Trajectories</h2>
        <canvas id="variance-canvas" width="800" height="400"></canvas>

        <h2 class="graph-title">Frequency Distribution</h2>
        <canvas id="frequency-canvas" width="800" height="400"></canvas>

        <h2 class="graph-title">Bernoulli Trials</h2>
        <canvas id="bernoulli-canvas" width="800" height="400"></canvas>

        <h2 class="graph-title">Random Walk Behavior</h2>
        <canvas id="random-walk-canvas" width="800" height="400"></canvas>

        <button id="downloadBtn" style="display: none;">Download Results</button>
    </div>

    <h2>2. Observations on Mean and Variance</h2>
    <p>
        <strong>Overview:</strong> The behavior of mean and variance over time in stochastic processes can provide
        valuable insights into the nature of the processes involved. The following observations were made across four scenarios:
    </p>
    <h3>1. Relative Frequency (Empirical Distribution)</h3>
    <p>
        <strong>Mean Behavior:</strong> The relative frequency converges to the true probability as the number of trials increases,
        illustrating the Law of Large Numbers. The mean stabilizes around the expected value.
    </p>
    <p>
        <strong>Variance Behavior:</strong> The variance decreases with increasing trials, indicating greater precision in estimating the probability.
    </p>

    <h3>2. Absolute Frequency (Count-Based Distribution)</h3>
    <p>
        <strong>Mean Behavior:</strong> The mean approaches the expected number of successes, given by n × p, as trials increase.
    </p>
    <p>
        <strong>Variance Behavior:</strong> Variance increases linearly with the number of trials, reflecting growing variability.
    </p>

    <h3>3. Bernoulli Trials</h3>
    <p>
        <strong>Mean Behavior:</strong> The sample mean converges to the expected value as the number of trials increases, illustrating the Law of Large Numbers.
    </p>
    <p>
        <strong>Variance Behavior:</strong> Variance decreases with increasing trials, indicating more precise estimates.
    </p>

    <h3>4. Random Walks</h3>
    <p>
        <strong>Mean Behavior:</strong> In symmetric random walks, the mean remains at zero. In asymmetric walks, the mean shifts towards the drift direction.
    </p>
    <p>
        <strong>Variance Behavior:</strong> Variance increases linearly with time, indicating greater uncertainty in the position.
    </p>

    <script>
        const canvas = document.getElementById('plot-canvas');
        const meanCanvas = document.getElementById('mean-canvas');
        const varianceCanvas = document.getElementById('variance-canvas');
        const frequencyCanvas = document.getElementById('frequency-canvas');
        const bernoulliCanvas = document.getElementById('bernoulli-canvas');
        const randomWalkCanvas = document.getElementById('random-walk-canvas');
        const ctx = canvas.getContext('2d');
        const meanCtx = meanCanvas.getContext('2d');
        const varianceCtx = varianceCanvas.getContext('2d');
        const frequencyCtx = frequencyCanvas.getContext('2d');
        const bernoulliCtx = bernoulliCanvas.getContext('2d');
        const randomWalkCtx = randomWalkCanvas.getContext('2d');
        const runSimulationButton = document.getElementById('run-simulation');
        const downloadButton = document.getElementById('downloadBtn');

        // Function to generate random numbers from a Gaussian (normal) distribution
        function gaussianRandom(mean = 0, stdev = 1) {
            let u = 1 - Math.random(); // Subtraction to avoid log(0)
            let v = Math.random();
            let z = Math.sqrt(-2.0 * Math.log(u)) * Math.cos(2.0 * Math.PI * v);
            return z * stdev + mean;
        }

        // Function to simulate jumps
        function randomJump(p) {
            return Math.random() < p ? (Math.random() < 0.5 ? -1 : 1) : 0; // -1 or +1 with probability p
        }

        // Random walk simulation with Gaussian distribution steps for multiple paths
        function simulateRandomWalk(steps, dt, numPaths, jumpProb) {
            let paths = [];
            let means = new Array(steps + 1).fill(0);  // Initialize mean array
            let variances = new Array(steps + 1).fill(0); // Initialize variance array
            let counts = new Array(steps + 1).fill(0); // Count occurrences for mean and variance

            // Simulate multiple random walks
            for (let j = 0; j < numPaths; j++) {
                let path = [0];  // Initial value for each path
                for (let i = 1; i <= steps; i++) {
                    const gaussianStep = gaussianRandom(0, Math.sqrt(dt));  // Gaussian step
                    const jumpStep = randomJump(jumpProb); // Random jump
                    path.push(path[i - 1] + gaussianStep + jumpStep); // Update position
                }
                paths.push(path);

                // Calculate mean and variance
                path.forEach((value, index) => {
                    means[index] += value; // Accumulate for mean
                    counts[index] += 1; // Increment count for variance
                });
            }

            // Compute mean and variance
            means = means.map(m => m / numPaths); // Final mean
            paths.forEach(path => {
                path.forEach((value, index) => {
                    variances[index] += Math.pow(value - means[index], 2); // Accumulate for variance
                });
            });
            variances = variances.map(v => v / counts.length); // Final variance

            return { paths, means, variances };
        }

        // Plot the results
        function plotResults(steps, numPaths, jumpProb) {
            const results = simulateRandomWalk(steps, 0.01, numPaths, jumpProb);
            const { paths, means, variances } = results;

            // Plot all paths
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.beginPath();
            paths.forEach((path, index) => {
                ctx.strokeStyle = `rgba(0, 0, 255, ${index / numPaths})`; // Color for each path
                ctx.lineWidth = 1;
                ctx.moveTo(0, canvas.height / 2);
                path.forEach((point, i) => {
                    ctx.lineTo(i * (canvas.width / steps), canvas.height / 2 - point * 10); // Scaling for visibility
                });
                ctx.stroke();
            });

            // Plot mean
            meanCtx.clearRect(0, 0, meanCanvas.width, meanCanvas.height);
            meanCtx.beginPath();
            meanCtx.strokeStyle = 'red';
            meanCtx.lineWidth = 2;
            meanCtx.moveTo(0, meanCanvas.height / 2);
            means.forEach((mean, i) => {
                meanCtx.lineTo(i * (meanCanvas.width / steps), meanCanvas.height / 2 - mean * 10);
            });
            meanCtx.stroke();

            // Plot variance
            varianceCtx.clearRect(0, 0, varianceCanvas.width, varianceCanvas.height);
            varianceCtx.beginPath();
            varianceCtx.strokeStyle = 'green';
            varianceCtx.lineWidth = 2;
            varianceCtx.moveTo(0, varianceCanvas.height / 2);
            variances.forEach((variance, i) => {
                varianceCtx.lineTo(i * (varianceCanvas.width / steps), varianceCanvas.height / 2 - variance * 10);
            });
            varianceCtx.stroke();

            // Plot frequency distribution
            frequencyCtx.clearRect(0, 0, frequencyCanvas.width, frequencyCanvas.height);
            frequencyCtx.fillStyle = 'lightblue';
            frequencyCtx.fillRect(0, 0, frequencyCanvas.width, frequencyCanvas.height);

            // Generate frequency distribution histogram
            let frequency = new Array(steps).fill(0);
            paths.forEach(path => {
                path.forEach(point => {
                    let index = Math.floor((point + 10) * (steps / 20)); // Normalize point to fit histogram
                    if (index >= 0 && index < steps) {
                        frequency[index]++;
                    }
                });
            });

            frequency.forEach((count, index) => {
                frequencyCtx.fillStyle = 'blue';
                frequencyCtx.fillRect(index * (frequencyCanvas.width / steps), frequencyCanvas.height, 
                                      (frequencyCanvas.width / steps), -count * 5); // Scale for visibility
            });

            // Plot Bernoulli Trials
            const bernoulliResults = simulateBernoulliTrials(steps);
            bernoulliCtx.clearRect(0, 0, bernoulliCanvas.width, bernoulliCanvas.height);
            bernoulliCtx.fillStyle = 'lightgreen';
            bernoulliCtx.fillRect(0, 0, bernoulliCanvas.width, bernoulliCanvas.height);
            bernoulliCtx.beginPath();
            bernoulliCtx.strokeStyle = 'orange';
            bernoulliCtx.lineWidth = 2;
            bernoulliCtx.moveTo(0, bernoulliCanvas.height);
            bernoulliResults.forEach((value, i) => {
                bernoulliCtx.lineTo(i * (bernoulliCanvas.width / steps), bernoulliCanvas.height - value * 10);
            });
            bernoulliCtx.stroke();

            // Plot random walk behavior
            const randomWalkResults = simulateRandomWalkBehavior(steps);
            randomWalkCtx.clearRect(0, 0, randomWalkCanvas.width, randomWalkCanvas.height);
            randomWalkCtx.fillStyle = 'lightcoral';
            randomWalkCtx.fillRect(0, 0, randomWalkCanvas.width, randomWalkCanvas.height);
            randomWalkCtx.beginPath();
            randomWalkCtx.strokeStyle = 'purple';
            randomWalkCtx.lineWidth = 2;
            randomWalkCtx.moveTo(0, randomWalkCanvas.height);
            randomWalkResults.forEach((value, i) => {
                randomWalkCtx.lineTo(i * (randomWalkCanvas.width / steps), randomWalkCanvas.height - value * 10);
            });
            randomWalkCtx.stroke();
        }

        runSimulationButton.addEventListener('click', () => {
            const steps = parseInt(document.getElementById('steps').value);
            const numPaths = parseInt(document.getElementById('paths').value);
            const jumpProb = parseFloat(document.getElementById('jump-prob').value);
            plotResults(steps, numPaths, jumpProb);
            downloadButton.style.display = 'inline';
        });

        // Dummy functions for Bernoulli trials and random walk behavior
        function simulateBernoulliTrials(steps) {
            // Simulating Bernoulli trials for demonstration
            let results = [];
            for (let i = 0; i < steps; i++) {
                results.push(Math.random() < 0.5 ? 1 : 0); // 50% chance for success
            }
            return results;
        }

        function simulateRandomWalkBehavior(steps) {
            // Simulating random walk behavior
            let walk = [];
            for (let i = 0; i < steps; i++) {
                walk.push(Math.random() < 0.5 ? 1 : -1); // Random step
            }
            return walk;
        }
    </script>
</body>

</html>
